# Changelog

## v1.85 (2025-12-10)

### 修复
- **服务器编辑数据丢失问题** - 修复编辑服务器配置时数据库路径被清空的问题
  - 编辑服务器时只更新实际修改的字段，不再覆盖未修改的配置

---

## v1.84 (2025-12-10)

### 新功能
- **绑定用户搜索** - 在绑定用户列表中添加搜索功能
  - 支持按 Emby 用户名、Telegram 用户名、Telegram 昵称、Telegram ID 搜索
  - 快速定位特定绑定用户

---

## v1.80 (2025-12-10)

### 新功能
- **Telegram 用户绑定** - 支持 Emby 用户绑定 Telegram 账号，接收个人观影报告
  - 用户通过 Bot 发送 `/bind` 命令，输入 Emby 账号密码完成绑定
  - 绑定后自动接收个人专属的每日/每周/每月观影报告
  - 支持解绑操作

### 改进
- **Docker 日志限制** - 添加容器日志大小限制，防止日志文件过大

---

## v1.71 (2025-12-08)

### 修复
- **登录页面服务器列表问题** - 修复未登录时无法获取服务器列表的问题
  - 服务器 API 被认证中间件拦截，导致登录页面显示"未配置服务器"
  - 将 `/api/servers` 添加到公开路径，允许未认证访问

---

## v1.7 (2025-12-08)

### 新功能
- **多服务器支持** - 支持管理多个 Emby 服务器
  - 在 Web 界面添加、编辑、删除服务器配置
  - 登录时可选择要连接的服务器
  - 支持设置默认服务器
  - 旧版环境变量配置自动迁移
- **文件选择器** - 添加服务器时可通过文件浏览器选择数据库路径
  - 浏览容器内文件系统
  - 支持快捷路径跳转
  - 直接选择 .db 数据库文件

### 改进
- **界面优化** - 调整面板背景透明度，提升文字可读性

---

## v1.6 (2025-12-07)

### 改进
- **动画与UI优化** - 优化了一些动画效果与UI微调

---

## v1.57 (2025-12-06)

### 新功能
- **Telegram 代理支持** - 支持在 Web 界面配置 Telegram 推送代理
  - 支持 HTTP 代理（如 `http://127.0.0.1:7890`）
  - 支持 SOCKS5 代理（如 `socks5://127.0.0.1:1080`）
  - 在「观影报告」设置页面可直接配置

---

## v1.51 (2025-12-04)

### 改进
- **UI 优化** - 界面样式调整与改进

---

## v1.5 (2025-12-04)

### 新功能
- **观影报告推送** - 支持通过 Telegram Bot 推送观影报告
  - 三个独立定时任务：每日报告、每周报告、每月报告
  - 每个任务可单独启用/禁用，自定义 Cron 表达式
  - 支持手动触发发送，可选择发送哪个周期的报告
  - 报告内容包含：观看时长、播放次数、观看内容数、热门内容排行
  - 美化的报告图片：现代深色主题、渐变背景、海报阴影、排名颜色

### 改进
- **内容统计去重** - 观看内容数量现在按 ItemId 去重，同一集播放多次只算1个内容
- **时间范围过滤** - 报告数据严格按照时间范围过滤（今日/本周/本月）

---

## v1.4 (2025-12-04)

### 新功能
- **历史记录搜索** - 支持按内容名称搜索播放历史
  - 搜索时自动使用全库范围，不受时间筛选限制
  - 搜索结果以列表形式展示（封面 + 内容名称 + 用户 + 时间 + 播放时长 + 客户端 + 设备）
  - 正常浏览时仍使用海报网格展示
  - 搜索同样遵循 `MIN_PLAY_DURATION` 环境变量的过滤规则

---

## v1.3 (2025-12-03)

### 新功能
- **Web 界面名称映射配置** - 可直接在设置面板中配置客户端/设备名称映射
- **设置面板** - 右上角新增设置按钮，支持在线配置

### 改进
- 名称映射配置自动保存到 `/config/name_mappings.json`

---

## v1.2 (2025-12-02)

### 新功能
- **MIN_PLAY_DURATION 环境变量** - 支持过滤播放时长过短的记录
- **播放时长过滤** - 低于设定时长的记录不计入历史和统计

---

## v1.1 (2025-12-01)

### 新功能
- **名称映射** - 支持通过配置文件自定义客户端/设备显示名称
- **PWA 支持** - 可添加到手机主屏幕作为独立应用

---

## v1.0 (2025-11-30)

### 初始版本
- 实时播放监控
- 播放趋势分析
- 热门内容排行
- 用户统计
- 设备/客户端统计
- 播放历史记录
- 管理员认证登录
